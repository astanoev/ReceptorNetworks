# ReceptorNetworks
MATLAB code for simulating dynamics of receptor networks
========================

MATLAB library developed to produce the results for the paper 

[Stanoev, Angel, Akhilesh P. Nandan, and Aneta Koseska. "Organization at criticality enables processing of time-varying signals by receptor networks" Mol Syst Biol (2020) 16: e8870](https://doi.org/10.15252/msb.20198870).

and for the previous version on

[Stanoev, Angel, Akhilesh P. Nandan, and Aneta Koseska. "Optimal biochemical information processing at criticality." BioRxiv (2019): 543348.](https://www.biorxiv.org/content/10.1101/543348v1.full.pdf).

-------------------------
Requirements
-------------------------

The code has been tested successfully with older versions of MATLAB (R2016a (9.0)) and with the latest version (R2019b (9.7)) on Windows.

Using the framework
===================

Good starting point is running the figure-generating or movie-generating scripts, as they reproduce the main results and simulations. In each figure class the subfigure plots are generated by a separate function. 

-----------------------------------------------------------

In general, for running simulations of a customized model, it needs to be defined first, similar to the way the other models are defined (labels, df_model function, etc).
Same holds for the experiment type (pulsed, sustained, step-wise increasing/decreasing, etc.).
Then the two objects are combined in a model_simulation object that can run deterministic/stochastic simulations and plot results.
Sample code:

```matlab
model = models.simple_dnf_model;  % create model object
model.par.g1 = 2.957;  % set regime of operation by setting the parameter(s); in this case the criticality regime
mpe = experiments.multi_pulse_experiment(2);  % create experiment object - multiple pulses at regular intervals
ms = model_simulation(model, mpe);  % combine the two in a model_simulation object 
ms.simulate();  % run deterministic simulations
ms.plot_fraction_active();  % plot the results
```

One can also animate a stochastic simulation, where the state space is updated, resulting in temporal changes:

```matlab
ms.stochastic_simulation();
ms.animate();
```

Different types of experiments can be simulated, such as streams of pulses for example:

```matlab
experiments.stream_pulse_experiment(n_pulses, lambda, t_total_min)
```

or different models can be used:

```matlab
model = models.model_2comp();
```

To run a stochastic single-molecule simulation simply define an animation and plot the execution:

```matlab
absa = abs_animation('ics_hl',1,'g1',4.95); % ics_hl=1 for high Ra initial conditions; also set g1 parameter
absa.plot_all();
```